{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user profile within the Spotly application, mirroring the structure stored in Firestore.",
      "properties": {
        "walletAddress": {
          "type": "string",
          "description": "The Solana wallet address of the user, used as the unique identifier (document ID) in Firestore and the Firebase Auth uid."
        },
        "username": {
          "type": "string",
          "description": "The user's display name or username."
        },
        "role": {
          "type": "string",
          "description": "The user's role within the application ('regular', 'fan', 'artist', 'business').",
          "format": "string"
        },
        "bio": {
          "type": "string",
          "description": "A short biography or description of the user."
        },
        "profilePhotoUrl": {
          "type": "string",
          "description": "URL of the user's profile photo.",
          "format": "uri"
        },
        "bannerPhotoUrl": {
          "type": "string",
          "description": "URL of the user's banner photo.",
          "format": "uri"
        },
        "socialLinks": {
          "type": "string",
          "description": "JSON string containing links to the user's social media profiles.",
          "format": "string"
        },
        "extraLinks": {
          "type": "string",
          "description": "JSON string containing additional links provided by the user.",
          "format": "string"
        },
        "skills": {
          "type": "string",
          "description": "A comma-separated list of the user's skills."
        },
        "tags": {
          "type": "string",
          "description": "A comma-separated list of tags associated with the user."
        },
        "location": {
          "type": "string",
          "description": "The user's location."
        },
        "rankingScore": {
          "type": "number",
          "description": "A score representing the user's ranking on the platform."
        },
        "escrowBalance": {
          "type": "number",
          "description": "The user's current escrow balance."
        },
        "isBanned": {
          "type": "boolean",
          "description": "Indicates whether the user is banned from the platform."
        },
        "isSuspended": {
          "type": "boolean",
          "description": "Indicates whether the user's account is suspended."
        },
        "suspensionReason": {
          "type": "string",
          "description": "The reason for the user's suspension."
        },
        "warnings": {
          "type": "number",
          "description": "The number of warnings the user has received."
        },
        "adminNotes": {
          "type": "string",
          "description": "Notes added by administrators regarding the user."
        },
        "isDeleted": {
          "type": "boolean",
          "description": "Indicates whether the user's account is marked as deleted."
        },
        "talentCategory": {
          "type": "string",
          "description": "The primary talent category of the user (e.g., 'music', 'acting', 'creator')."
        },
        "talentSubcategories": {
          "type": "string",
          "description": "JSON string containing an array of subcategories related to the user's talent.",
          "format": "string"
        },
        "subRole": {
          "type": "string",
          "description": "A more specific role or sub-role of the user (e.g., 'singer', 'actor')."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the user's profile was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp indicating when the user's profile was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "walletAddress",
        "username",
        "role",
        "bio",
        "profilePhotoUrl",
        "bannerPhotoUrl",
        "socialLinks",
        "extraLinks",
        "skills",
        "tags",
        "location",
        "rankingScore",
        "escrowBalance",
        "isBanned",
        "isSuspended",
        "suspensionReason",
        "warnings",
        "adminNotes",
        "isDeleted",
        "talentCategory",
        "talentSubcategories",
        "subRole",
        "createdAt",
        "updatedAt"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{walletAddress}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information. The 'walletAddress' serves as both the document ID and the Firebase Auth UID (Solana public key), ensuring direct ownership and simplifying security rules. Includes all user profile data as defined in the provided schema.",
          "params": [
            {
              "name": "walletAddress",
              "description": "The Solana wallet address of the user, functioning as the document ID and Firebase Auth UID."
            }
          ]
        }
      }
    ],
    "reasoning": "This Firestore structure is designed to manage user authentication and profiles using Firebase, focusing on replacing the existing Devbase user management system with Firebase Auth and Firestore. It prioritizes Authorization Independence by avoiding hierarchical `get()` calls in security rules. The `users` collection stores user profiles, with the document ID matching the Firebase Auth `uid` (Solana wallet address), ensuring direct access and simplifying security rules based on user ownership. All data in `users` collection has the same security requirements. The structure enables secure `list` operations (QAPs) by storing user data directly in the `users` collection, avoiding the need to filter based on parent document data.  Specifically, this structure avoids hierarchical dependencies, enabling atomic operations. Roles are stored directly in the database (DBAC), relying solely on `request.auth.uid` for authorization."
  }
}